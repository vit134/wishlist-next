{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _Array$from from \"@babel/runtime-corejs2/core-js/array/from\";\nvar __jsx = React.createElement;\nimport React, { Fragment, useState } from 'react';\nimport { Container } from 'react-bootstrap';\nimport { Header } from '../header';\nimport { loginRequest, logoutRequest, registrationRequest, addWishRequest } from '../../requests';\nimport styles from './styles.css';\n\nconst getFormFields = form => {\n  return _Array$from(form).reduce((acc, node) => {\n    if (node.name) {\n      if (node.name === 'image') {\n        console.log(node, node.files[0]);\n      }\n\n      acc[node.name] = node.value;\n    }\n\n    return acc;\n  }, {});\n};\n\nconst Layout = ({\n  user,\n  children\n}) => {\n  const {\n    0: userInfo,\n    1: setUser\n  } = useState(user);\n  const {\n    0: isPopupOpen,\n    1: togglePopup\n  } = useState(false);\n  const {\n    0: formErorrs,\n    1: setFormErrors\n  } = useState({});\n\n  const handleLogin = e => {\n    e.preventDefault();\n    const data = getFormFields(e.target);\n    loginRequest(_JSON$stringify(data)).then(({\n      data\n    }) => {\n      setUser(data);\n      togglePopup(false);\n    }).catch(e => console.warn(e));\n  };\n\n  const handleLogout = () => logoutRequest().then(() => {\n    setUser({\n      isLogin: false,\n      data: null\n    });\n  });\n\n  const handleRegistration = e => {\n    e.preventDefault();\n    const data = getFormFields(e.target);\n    registrationRequest(data).then(({\n      data\n    }) => {\n      const {\n        status,\n        user,\n        error\n      } = data;\n\n      if (status === 'success') {\n        setUser({\n          isLogin: true,\n          data: user\n        });\n      } else {\n        setFormErrors({\n          [error.name]: error.message\n        });\n      }\n    }).catch(error => {\n      console.log(error.message);\n    });\n  };\n\n  const handleAddWish = e => {\n    e.preventDefault();\n    const data = new FormData(e.target);\n    console.log(data);\n    addWishRequest(data).then(response => console.log(response));\n  };\n\n  return __jsx(Fragment, null, __jsx(Header, {\n    isPopupOpen: isPopupOpen,\n    togglePopup: togglePopup,\n    user: userInfo,\n    onLogin: handleLogin,\n    onRegistration: handleRegistration,\n    onLogout: handleLogout,\n    onAddWish: handleAddWish,\n    formErorrs: formErorrs\n  }), __jsx(Container, null, __jsx(\"div\", {\n    className: styles['root-container']\n  }, children)));\n};\n\nexport default Layout;","map":null,"metadata":{},"sourceType":"module"}