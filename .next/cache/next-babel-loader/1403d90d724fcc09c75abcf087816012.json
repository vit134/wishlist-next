{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _Array$from from \"@babel/runtime-corejs2/core-js/array/from\";\nvar _jsxFileName = \"/Users/viandryushkov/my/ssr-wishlist/src/components/layout/layout.js\";\nvar __jsx = React.createElement;\nimport React, { Fragment, useState } from 'react';\nimport { Container } from 'react-bootstrap';\nimport { Header } from '../header';\nimport { loginRequest, logoutRequest, registrationRequest, addWishRequest } from '../../requests';\nimport styles from './styles.css';\n\nconst getFormFields = form => {\n  return _Array$from(form).reduce((acc, node) => {\n    if (node.name) {\n      if (node.name === 'image') {\n        console.log(node, node.files[0]);\n      }\n\n      acc[node.name] = node.value;\n    }\n\n    return acc;\n  }, {});\n};\n\nconst Layout = ({\n  user,\n  children\n}) => {\n  const {\n    0: userInfo,\n    1: setUser\n  } = useState(user);\n  const {\n    0: isPopupOpen,\n    1: togglePopup\n  } = useState(false);\n  const {\n    0: formErorrs,\n    1: setFormErrors\n  } = useState({});\n\n  const handleLogin = e => {\n    e.preventDefault();\n    const data = getFormFields(e.target);\n    loginRequest(_JSON$stringify(data)).then(({\n      data\n    }) => {\n      setUser(data);\n      togglePopup(false);\n    }).catch(e => console.warn(e));\n  };\n\n  const handleLogout = () => logoutRequest().then(() => {\n    setUser({\n      isLogin: false,\n      data: null\n    });\n  });\n\n  const handleRegistration = e => {\n    e.preventDefault();\n    const data = getFormFields(e.target);\n    registrationRequest(data).then(({\n      data\n    }) => {\n      const {\n        status,\n        user,\n        error\n      } = data;\n\n      if (status === 'success') {\n        setUser({\n          isLogin: true,\n          data: user\n        });\n      } else {\n        setFormErrors({\n          [error.name]: error.message\n        });\n      }\n    }).catch(error => {\n      console.log(error.message);\n    });\n  };\n\n  const handleAddWish = e => {\n    e.preventDefault();\n    const data = new FormData(e.target);\n    console.log(data);\n    addWishRequest(data).then(response => console.log(response));\n  };\n\n  return __jsx(Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  }, __jsx(Header, {\n    isPopupOpen: isPopupOpen,\n    togglePopup: togglePopup,\n    user: userInfo,\n    onLogin: handleLogin,\n    onRegistration: handleRegistration,\n    onLogout: handleLogout,\n    onAddWish: handleAddWish,\n    formErorrs: formErorrs,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }), __jsx(Container, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: styles['root-container'],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, children)));\n};\n\nexport default Layout;","map":{"version":3,"sources":["/Users/viandryushkov/my/ssr-wishlist/src/components/layout/layout.js"],"names":["React","Fragment","useState","Container","Header","loginRequest","logoutRequest","registrationRequest","addWishRequest","styles","getFormFields","form","reduce","acc","node","name","console","log","files","value","Layout","user","children","userInfo","setUser","isPopupOpen","togglePopup","formErorrs","setFormErrors","handleLogin","e","preventDefault","data","target","then","catch","warn","handleLogout","isLogin","handleRegistration","status","error","message","handleAddWish","FormData","response"],"mappings":"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","sourcesContent":["import React, { Fragment, useState } from 'react';\nimport { Container } from 'react-bootstrap';\nimport { Header } from '../header';\nimport { loginRequest, logoutRequest, registrationRequest, addWishRequest } from '../../requests';\nimport styles from './styles.css';\n\nconst getFormFields = (form) => {\n  return Array.from(form).reduce((acc, node) => {\n    if (node.name) {\n      if (node.name === 'image') {\n        console.log(node, node.files[0]);\n      }\n      acc[node.name] = node.value;\n    }\n    return acc;\n  }, {});\n};\n\nconst Layout = ({ user, children }) => {\n  const [userInfo, setUser] = useState(user);\n  const [isPopupOpen, togglePopup] = useState(false);\n  const [formErorrs, setFormErrors] = useState({});\n\n  const handleLogin = (e) => {\n    e.preventDefault();\n\n    const data = getFormFields(e.target);\n\n    loginRequest(JSON.stringify(data))\n      .then(({ data }) => {\n        setUser(data);\n        togglePopup(false);\n      })\n      .catch(e => console.warn(e));\n  };\n\n  const handleLogout = () => (\n    logoutRequest().then(() => {\n      setUser({\n        isLogin: false,\n        data: null\n      });\n    })\n  );\n\n  const handleRegistration = (e) => {\n    e.preventDefault();\n\n    const data = getFormFields(e.target);\n\n    registrationRequest(data)\n      .then(({ data }) => {\n        const { status, user, error } = data;\n        if (status === 'success') {\n          setUser({ isLogin: true, data: user });\n        } else {\n          setFormErrors({\n            [error.name]: error.message\n          });\n        }\n      })\n      .catch((error) => {\n        console.log(error.message);\n      });\n  };\n\n  const handleAddWish = (e) => {\n    e.preventDefault();\n\n    const data = new FormData(e.target);\n    console.log(data);\n\n    addWishRequest(data)\n      .then(response => console.log(response))\n  };\n\n  return (\n    <Fragment>\n      <Header\n        isPopupOpen={isPopupOpen}\n        togglePopup={togglePopup}\n        user={userInfo}\n        onLogin={handleLogin}\n        onRegistration={handleRegistration}\n        onLogout={handleLogout}\n        onAddWish={handleAddWish}\n        formErorrs={formErorrs}\n      />\n      <Container>\n        <div className={styles['root-container']}>\n          { children }\n        </div>\n      </Container>\n    </Fragment>\n  );\n};\n\nexport default Layout;\n"]},"metadata":{},"sourceType":"module"}