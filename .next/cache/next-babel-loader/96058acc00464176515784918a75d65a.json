{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _Array$from from \"@babel/runtime-corejs2/core-js/array/from\";\nvar _jsxFileName = \"/Users/viandryushkov/my/ssr-wishlist/src/components/layout/layout.js\";\nvar __jsx = React.createElement;\nimport React, { Fragment, useState } from 'react';\nimport { Container } from 'react-bootstrap';\nimport { Header } from '../header';\nimport { loginRequest, logoutRequest, registrationRequest, addWishRequest } from '../../requests';\nimport styles from './styles.css';\n\nvar getFormFields = function getFormFields(form) {\n  return _Array$from(form).reduce(function (acc, node) {\n    if (node.name) {\n      if (node.name === 'image') {\n        console.log(node, node.files[0]);\n      }\n\n      acc[node.name] = node.value;\n    }\n\n    return acc;\n  }, {});\n};\n\nvar Layout = function Layout(_ref) {\n  var user = _ref.user,\n      children = _ref.children;\n\n  var _useState = useState(user),\n      userInfo = _useState[0],\n      setUser = _useState[1];\n\n  var _useState2 = useState(false),\n      isPopupOpen = _useState2[0],\n      togglePopup = _useState2[1];\n\n  var _useState3 = useState({}),\n      formErorrs = _useState3[0],\n      setFormErrors = _useState3[1];\n\n  var handleLogin = function handleLogin(e) {\n    e.preventDefault();\n    var data = getFormFields(e.target);\n    loginRequest(_JSON$stringify(data)).then(function (_ref2) {\n      var data = _ref2.data;\n      setUser(data);\n      togglePopup(false);\n    })[\"catch\"](function (e) {\n      return console.warn(e);\n    });\n  };\n\n  var handleLogout = function handleLogout() {\n    return logoutRequest().then(function () {\n      setUser({\n        isLogin: false,\n        data: null\n      });\n    });\n  };\n\n  var handleRegistration = function handleRegistration(e) {\n    e.preventDefault();\n    var data = getFormFields(e.target);\n    registrationRequest(data).then(function (_ref3) {\n      var data = _ref3.data;\n      var status = data.status,\n          user = data.user,\n          error = data.error;\n\n      if (status === 'success') {\n        setUser({\n          isLogin: true,\n          data: user\n        });\n      } else {\n        setFormErrors(_defineProperty({}, error.name, error.message));\n      }\n    })[\"catch\"](function (error) {\n      console.log(error.message);\n    });\n  };\n\n  var handleAddWish = function handleAddWish(e) {\n    e.preventDefault();\n    var data = new FormData(e.target);\n    console.log(data);\n    addWishRequest(data).then(function (response) {\n      return console.log(response);\n    });\n  };\n\n  return __jsx(Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  }, __jsx(Header, {\n    isPopupOpen: isPopupOpen,\n    togglePopup: togglePopup,\n    user: userInfo,\n    onLogin: handleLogin,\n    onRegistration: handleRegistration,\n    onLogout: handleLogout,\n    onAddWish: handleAddWish,\n    formErorrs: formErorrs,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }), __jsx(Container, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: styles['root-container'],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, children)));\n};\n\nexport default Layout;","map":{"version":3,"sources":["/Users/viandryushkov/my/ssr-wishlist/src/components/layout/layout.js"],"names":["React","Fragment","useState","Container","Header","loginRequest","logoutRequest","registrationRequest","addWishRequest","styles","getFormFields","form","reduce","acc","node","name","console","log","files","value","Layout","user","children","userInfo","setUser","isPopupOpen","togglePopup","formErorrs","setFormErrors","handleLogin","e","preventDefault","data","target","then","warn","handleLogout","isLogin","handleRegistration","status","error","message","handleAddWish","FormData","response"],"mappings":"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","sourcesContent":["import React, { Fragment, useState } from 'react';\nimport { Container } from 'react-bootstrap';\nimport { Header } from '../header';\nimport { loginRequest, logoutRequest, registrationRequest, addWishRequest } from '../../requests';\nimport styles from './styles.css';\n\nconst getFormFields = (form) => {\n  return Array.from(form).reduce((acc, node) => {\n    if (node.name) {\n      if (node.name === 'image') {\n        console.log(node, node.files[0]);\n      }\n      acc[node.name] = node.value;\n    }\n    return acc;\n  }, {});\n};\n\nconst Layout = ({ user, children }) => {\n  const [userInfo, setUser] = useState(user);\n  const [isPopupOpen, togglePopup] = useState(false);\n  const [formErorrs, setFormErrors] = useState({});\n\n  const handleLogin = (e) => {\n    e.preventDefault();\n\n    const data = getFormFields(e.target);\n\n    loginRequest(JSON.stringify(data))\n      .then(({ data }) => {\n        setUser(data);\n        togglePopup(false);\n      })\n      .catch(e => console.warn(e));\n  };\n\n  const handleLogout = () => (\n    logoutRequest().then(() => {\n      setUser({\n        isLogin: false,\n        data: null\n      });\n    })\n  );\n\n  const handleRegistration = (e) => {\n    e.preventDefault();\n\n    const data = getFormFields(e.target);\n\n    registrationRequest(data)\n      .then(({ data }) => {\n        const { status, user, error } = data;\n        if (status === 'success') {\n          setUser({ isLogin: true, data: user });\n        } else {\n          setFormErrors({\n            [error.name]: error.message\n          });\n        }\n      })\n      .catch((error) => {\n        console.log(error.message);\n      });\n  };\n\n  const handleAddWish = (e) => {\n    e.preventDefault();\n\n    const data = new FormData(e.target);\n    console.log(data);\n\n    addWishRequest(data)\n      .then(response => console.log(response))\n  };\n\n  return (\n    <Fragment>\n      <Header\n        isPopupOpen={isPopupOpen}\n        togglePopup={togglePopup}\n        user={userInfo}\n        onLogin={handleLogin}\n        onRegistration={handleRegistration}\n        onLogout={handleLogout}\n        onAddWish={handleAddWish}\n        formErorrs={formErorrs}\n      />\n      <Container>\n        <div className={styles['root-container']}>\n          { children }\n        </div>\n      </Container>\n    </Fragment>\n  );\n};\n\nexport default Layout;\n"]},"metadata":{},"sourceType":"module"}