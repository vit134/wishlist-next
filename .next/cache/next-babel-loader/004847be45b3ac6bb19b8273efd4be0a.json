{"ast":null,"code":"import _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _Array$from from \"@babel/runtime-corejs2/core-js/array/from\";\nvar __jsx = React.createElement;\nimport React, { Fragment, useState } from 'react';\nimport { Container } from 'react-bootstrap';\nimport { Header } from '../header';\nimport { loginRequest, logoutRequest, registrationRequest, addWishRequest } from '../../requests';\nimport styles from './styles.css';\n\nvar getFormFields = function getFormFields(form) {\n  return _Array$from(form).reduce(function (acc, node) {\n    if (node.name) {\n      if (node.name === 'image') {\n        console.log(node, node.files[0]);\n      }\n\n      acc[node.name] = node.value;\n    }\n\n    return acc;\n  }, {});\n};\n\nvar Layout = function Layout(_ref) {\n  var user = _ref.user,\n      children = _ref.children;\n\n  var _useState = useState(user),\n      userInfo = _useState[0],\n      setUser = _useState[1];\n\n  var _useState2 = useState(false),\n      isPopupOpen = _useState2[0],\n      togglePopup = _useState2[1];\n\n  var _useState3 = useState({}),\n      formErorrs = _useState3[0],\n      setFormErrors = _useState3[1];\n\n  var handleLogin = function handleLogin(e) {\n    e.preventDefault();\n    var data = getFormFields(e.target);\n    loginRequest(_JSON$stringify(data)).then(function (_ref2) {\n      var data = _ref2.data;\n      setUser(data);\n      togglePopup(false);\n    })[\"catch\"](function (e) {\n      return console.warn(e);\n    });\n  };\n\n  var handleLogout = function handleLogout() {\n    return logoutRequest().then(function () {\n      setUser({\n        isLogin: false,\n        data: null\n      });\n    });\n  };\n\n  var handleRegistration = function handleRegistration(e) {\n    e.preventDefault();\n    var data = getFormFields(e.target);\n    registrationRequest(data).then(function (_ref3) {\n      var data = _ref3.data;\n      var status = data.status,\n          user = data.user,\n          error = data.error;\n\n      if (status === 'success') {\n        setUser({\n          isLogin: true,\n          data: user\n        });\n      } else {\n        setFormErrors(_defineProperty({}, error.name, error.message));\n      }\n    })[\"catch\"](function (error) {\n      console.log(error.message);\n    });\n  };\n\n  var handleAddWish = function handleAddWish(e) {\n    e.preventDefault();\n    var data = new FormData(e.target);\n    console.log(data);\n    addWishRequest(data).then(function (response) {\n      return console.log(response);\n    });\n  };\n\n  return __jsx(Fragment, null, __jsx(Header, {\n    isPopupOpen: isPopupOpen,\n    togglePopup: togglePopup,\n    user: userInfo,\n    onLogin: handleLogin,\n    onRegistration: handleRegistration,\n    onLogout: handleLogout,\n    onAddWish: handleAddWish,\n    formErorrs: formErorrs\n  }), __jsx(Container, null, __jsx(\"div\", {\n    className: styles['root-container']\n  }, children)));\n};\n\nexport default Layout;","map":null,"metadata":{},"sourceType":"module"}